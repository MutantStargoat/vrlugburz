#ifndef OPENGL_H_
#define OPENGL_H_

#ifdef WIN32
#include <windows.h>
#endif

/* stop gl.h from including glext before we check the GL_VERSION macros */
#define GL_GLEXT_LEGACY
#include <GL/gl.h>

#ifdef GL_VERSION_1_1
#define BUILD_GL11
#endif
#ifdef GL_VERSION_1_2
#define BUILD_GL12
#endif
#ifdef GL_VERSION_1_3
#define BUILD_GL13
#endif
#ifdef GL_VERSION_1_4
#define BUILD_GL14
#endif
#ifdef GL_VERSION_1_5
#define BUILD_GL15
#endif
#ifdef GL_VERSION_2_0
#define BUILD_GL20
#endif
#ifdef GL_VERSION_2_1
#define BUILD_GL21
#endif

#include <GL/glext.h>

enum {
	GLCAPS_SDR		= 0x0001,
	GLCAPS_VBO		= 0x0002,
	GLCAPS_FBO		= 0x0004,
	GLCAPS_FB_SRGB	= 0x0008,
	GLCAPS_TEX_SRGB	= 0x0010,
	GLCAPS_TEX_FLOAT = 0x0020,
	GLCAPS_DEBUG	= 0x8000
};

struct glcaps {
	int ver_major, ver_minor;
	unsigned int caps;
	int max_tex_units;
} glcaps;

#ifndef BUILD_GL13
PFNGLACTIVETEXTUREPROC glActiveTexture;
#endif

#ifndef BUILD_GL15
PFNGLGENBUFFERSPROC glGenBuffers;
PFNGLDELETEBUFFERSPROC glDeleteBuffers;
PFNGLBINDBUFFERPROC glBindBuffer;
PFNGLBUFFERDATAPROC glBufferData;
#endif

#ifndef BUILD_GL20
PFNGLCREATEPROGRAMPROC glCreateProgram;
PFNGLDELETEPROGRAMPROC glDeleteProgram;
PFNGLATTACHSHADERPROC glAttachShader;
PFNGLLINKPROGRAMPROC glLinkProgram;
PFNGLGETPROGRAMIVPROC glGetProgramiv;
PFNGLGETPROGRAMINFOLOGPROC glGetProgramInfoLog;
PFNGLUSEPROGRAMPROC glUseProgram;
PFNGLGETUNIFORMLOCATIONPROC glGetUniformLocation;
PFNGLUNIFORM1IPROC glUniform1i;
PFNGLUNIFORM1FPROC glUniform1f;
PFNGLUNIFORM2FPROC glUniform2f;
PFNGLUNIFORM3FPROC glUniform3f;
PFNGLUNIFORM4FPROC glUniform4f;
PFNGLUNIFORMMATRIX4FVPROC glUniformMatrix4fv;
PFNGLGETATTRIBLOCATIONPROC glGetAttribLocation;
PFNGLVERTEXATTRIB3FPROC glVertexAttrib3f;
PFNGLCREATESHADERPROC glCreateShader;
PFNGLDELETESHADERPROC glDeleteShader;
PFNGLSHADERSOURCEPROC glShaderSource;
PFNGLCOMPILESHADERPROC glCompileShader;
PFNGLGETSHADERIVPROC glGetShaderiv;
PFNGLGETSHADERINFOLOGPROC glGetShaderInfoLog;
PFNGLBINDATTRIBLOCATIONPROC glBindAttribLocation;
PFNGLENABLEVERTEXATTRIBARRAYPROC glEnableVertexAttribArray;
PFNGLDISABLEVERTEXATTRIBARRAYPROC glDisableVertexAttribArray;
PFNGLVERTEXATTRIBPOINTERPROC glVertexAttribPointer;
#endif

PFNGLGENFRAMEBUFFERSPROC glGenFramebuffers;
PFNGLDELETEFRAMEBUFFERSPROC glDeleteFramebuffers;
PFNGLBINDFRAMEBUFFERPROC glBindFramebuffer;
PFNGLFRAMEBUFFERTEXTURE2DPROC glFramebufferTexture2D;
PFNGLFRAMEBUFFERRENDERBUFFERPROC glFramebufferRenderbuffer;
PFNGLGENRENDERBUFFERSPROC glGenRenderbuffers;
PFNGLDELETERENDERBUFFERSPROC glDeleteRenderbuffers;
PFNGLBINDRENDERBUFFERPROC glBindRenderbuffer;
PFNGLRENDERBUFFERSTORAGEPROC glRenderbufferStorage;
PFNGLCHECKFRAMEBUFFERSTATUSPROC glCheckFramebufferStatus;
PFNGLDRAWBUFFERSPROC glDrawBuffers;

PFNGLBLITFRAMEBUFFERPROC glBlitFramebuffer;

PFNGLDEBUGMESSAGECALLBACKPROC glDebugMessageCallback;

int init_opengl(void);

int nextpow2(int x);

#endif	/* OPENGL_H_ */
